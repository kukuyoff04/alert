# à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹„à¸Ÿà¸¥à¹Œ: .github/workflows/water_alert.yml

name: ðŸŒŠ Inburi Water Level Alert

on:
  schedule:
    # 1. à¸•à¸±à¹‰à¸‡à¹€à¸§à¸¥à¸²à¸—à¸³à¸‡à¸²à¸™: à¸£à¸±à¸™à¸—à¸¸à¸ 1 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡ (à¸—à¸µà¹ˆà¸™à¸²à¸—à¸µà¸—à¸µà¹ˆ 0 à¸‚à¸­à¸‡à¸—à¸¸à¸à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡)
    - cron: '0 * * * *'
    
  workflow_dispatch:
    # 2. à¹€à¸žà¸´à¹ˆà¸¡à¸›à¸¸à¹ˆà¸¡à¹ƒà¸«à¹‰à¸à¸”à¸£à¸±à¸™à¹€à¸­à¸‡à¹„à¸”à¹‰: à¹„à¸›à¸—à¸µà¹ˆà¹à¸—à¹‡à¸š Actions à¹ƒà¸™ GitHub à¹à¸¥à¹‰à¸§à¸à¸” "Run workflow"

jobs:
  scrape-and-notify:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Check out repository
        uses: actions/checkout@v4

      - name: 2. Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: 3. Install Python dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: 4. Install Playwright browser
        # à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ chromium à¹à¸¥à¸° dependencies à¸—à¸µà¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™
        run: playwright install --with-deps chromium

      - name: 5. Run scraper script
        env:
          # 3. à¸”à¸¶à¸‡ Token à¸¡à¸²à¸ˆà¸²à¸ Secrets à¸‚à¸­à¸‡ Repository
          #    (à¸„à¸¸à¸“à¸•à¹‰à¸­à¸‡à¹„à¸›à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹€à¸­à¸‡à¹ƒà¸™ Settings > Secrets and variables > Actions)
          LINE_CHANNEL_ACCESS_TOKEN: ${{ secrets.LINE_CHANNEL_ACCESS_TOKEN }}
        run: python scrape_water.py
